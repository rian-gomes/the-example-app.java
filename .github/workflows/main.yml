name: Login na API

on:
  push:
    branches:
      - master

jobs:
  login:
    runs-on: ubuntu-latest

    steps:
    - name: Verificar código
      uses: actions/checkout@v2

    - name: Fazer login na API
      env:
        API_EMAIL: ${{ secrets.API_EMAIL }}
        API_PASSWORD: ${{ secrets.API_PASSWORD }}
      run: |
        # Faz o login na API usando as variáveis de ambiente API_EMAIL e API_PASSWORD
        curl -X 'POST' 'https://auth.development.xguardianplatform.io/login' \
          -H 'accept: application/json' \
          -H 'Content-Type: application/json' \
          -d '{
            "email": "'"${API_EMAIL}"'",
            "password": "'"${API_PASSWORD}"'"
          }'
